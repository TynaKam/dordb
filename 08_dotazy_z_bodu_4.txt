--1. Seznam všech receptu(nazev,popis), které obsahují množinu vybraných ingrediencí.

SELECT 
r.NAME AS "Recipe name", 
r.DESCRIPTION as "Description"
FROM RECIPE r
inner join RECIPE_INGREDIENT ri
on r.ID_RECIPE =  ri.ID_RECIPE
inner join INGREDIENT i
on i.ID_INGREDIENT = ri.ID_INGREDIENT
where i.INGREDIENT_NAME = 'sapien.' OR i.INGREDIENT_NAME = 'lorem semper' OR  i.INGREDIENT_NAME = 'sit' OR i.INGREDIENT_NAME = 'pede blandit'
order by r.rating
DESC;


--2. Seznam všech receptu z dané kategorie serazených podle hodnocení.
SELECT 
r.NAME AS "Recipe name", 
c.category_name as "Category name",
r.rating as "Rating"
FROM RECIPE r
inner join RECIPE_CATEGORY rc
on r.ID_RECIPE =  rc.ID_RECIPE
inner join CATEGORY c
on rc.ID_CATEGORY = c.ID_CATEGORY
where c.CATEGORY_NAME = 'Soup'
order by r.rating
DESC;

--3. Seznam 50 uživatelu podle hodnocení a jejich nejcasteji hodnocený recept



--4. Recepty daného uživatele podle hodnocení.
select a.USERNAME as Username, r.rating as Rating, r.DESCRIPTION as Description from Recipe r
join APPUSER a on
r.ID_APP_USER = a.ID_APP_USER
where  a.USERNAME = 'sit'
order by r.RATING desc;
--5. Seznam zákazníku (login, jméno, príjmení, hodnocení a pocet nahraných receptu) serezených podle hodnocení
select a.username as Username, a.name as Name, a.surname as Surname, a.rating as Rating, re.recipe_count as Recipe_count from
Appuser a
join ( select count(r.name) as recipe_count, id_app_user from Recipe r
group by id_app_user)  re on
a.ID_APP_USER = re.id_app_user
order by a.RATING desc;